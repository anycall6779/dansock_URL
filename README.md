# 주차 단속 OCR 웹 앱

Flask와 Google Cloud Vision API를 사용하여 주차 단속 사진에서 차량 번호판을 인식하고, 그 결과를 엑셀 파일로 저장 및 관리하는 웹 애플리케이션입니다.



## 🚨🚨🚨 중요: API 키 경고 🚨🚨🚨

이 프로젝트가 올바르게 작동하려면 Google Cloud Vision API의 인증 키 파일이 필요합니다.

현재 프로젝트 소유자는 보안상의 이유로 `CLOUD VISION API/API.json` 파일을 **삭제하면 비활성화할 예정**입니다.

**이 프로젝트를 다운로드하여 사용하려는 분은 반드시 다음 단계를 따라 자신만의 API 키를 발급받아 교체해야 합니다.**

1.  Google Cloud Platform(GCP)에서 새 프로젝트를 생성합니다.
2.  해당 프로젝트에서 **'Cloud Vision API'**를 검색하여 '사용 설정'합니다.
3.  'IAM 및 관리자' > '서비스 계정' 메뉴로 이동하여 새 서비스 계정을 만듭니다.
4.  생성된 서비스 계정의 '키' 탭에서 새 키를 만들고 **JSON** 형식으로 다운로드합니다.
5.  다운로드한 JSON 파일의 이름을 **`API.json`**으로 변경합니다.
6.  이 파일(새 `API.json`)을 프로젝트 내의 `CLOUD VISION API` 폴더에 덮어씁니다.

**이 과정을 완료하지 않으면 `web_app.py` 실행 시 인증 오류가 발생합니다.**

---

## ⚙️ 주요 기능

* **웹 인터페이스**: Flask 기반의 간단한 웹 UI 제공.
* **다중 파일 업로드**: 한 번에 여러 장의 단속 사진을 업로드할 수 있습니다.
* **번호판 인식**: Google Vision API를 통해 이미지 내 텍스트(번호판)를 자동 추출합니다.
* **결과 수정**: OCR이 실패하거나 잘못 인식한 번호판을 사용자가 직접 수정할 수 있는 확인 페이지를 제공합니다. (`result.html`)
* **이미지 미리보기**: 수정 페이지에서 파일명을 클릭하여 원본 사진을 모달 창으로 확인할 수 있습니다.
* **엑셀 저장**: 최종 수정된 내역을 날짜, 위치, 사유, 차량번호와 함께 `.xlsx` 파일로 자동 저장합니다.
* **일일 보고서**: 저장된 엑셀 내용을 바탕으로 일일 단속 현황을 요약하는 보고서 페이지(` /report `)를 생성합니다.

---

## 🗂️ 프로젝트 구조

```

/scan\_bot
├── CLOUD VISION API/
│   └── API.json          (🚨🚨🚨 반드시 당신의 키로 교체해야 함)
│
├── templates/            (HTML 템플릿)
│   ├── index.html        (메인 업로드 페이지)
│   ├── result.html       (OCR 결과 확인 및 수정 페이지)
│   ├── success.html      (저장 완료 페이지)
│   └── report.html       (일일 최종 보고서 페이지)
│
├── uploads/              (업로드된 이미지가 날짜/위치별로 저장됨)
│
├── web\_app.py            (메인 Flask 서버 로직)
├── ngrok.exe             (외부 접속 터널링 프로그램)
└── start.bat             (웹 서버와 ngrok을 동시에 실행하는 배치 파일)

````

---

## 🚀 실행 방법

### 1. 전제 조건

* **Python 3** 설치
* **Google Cloud API 키** (위의 경고 섹션 참조)

### 2. 라이브러리 설치

`web_app.py` 스크립트 내에 `pip`를 이용한 자동 설치 로직이 포함되어 있습니다.

만약 자동 설치가 실패할 경우, 터미널에서 직접 설치해주세요.
```bash
pip install flask pandas openpyxl google-cloud-vision
````

### 3\. 서버 실행

프로젝트 폴더(`scan_bot`)에 있는 **`start.bat`** 파일을 더블 클릭하여 실행합니다.

이 배치 파일은 다음 두 가지 작업을 동시에 수행합니다.

1.  **Flask 웹 서버** (`web_app.py`)를 실행합니다. (localhost:5000)
2.  **ngrok** (`ngrok.exe`)을 실행하여 `http 5000` 포트를 외부에서 접속할 수 있는 공용 URL로 열어줍니다.

### 4. 사용 방법

1.  `start.bat` 실행 시 나타나는 `ngrok` 터미널 창에서 \*\*'Forwarding'\*\*에 표시된 `https://...` 주소를 복사합니다.
2.  이 주소를 PC 또는 모바일 웹 브라우저에 붙여넣어 접속합니다.
3.  단속 위치와 사유를 선택하고 사진 파일을 업로드합니다.
4.  `result.html` 페이지에서 OCR 결과를 확인하고 필요시 수정합니다.
5.  최종 저장을 누르면 `success.html` 페이지로 이동하며, 엑셀 파일이 서버(`scan_bot` 폴더)에 저장됩니다.